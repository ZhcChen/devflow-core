# 工作流程（精简版）

## 阶段流转

```
[需求分析] → [PRD定稿] → [技术设计] → [方案定稿] → [编码] → [审查] → [测试] → [完成]
```

## 角色分工

- Orchestrator（主 Agent）：流程调度、决策/确认节点管理、状态维护
- PM（产品负责人）：需求拆解与 PRD
- Architect（架构师）：技术方案与架构设计
- Developer（开发）：按方案实现代码
- Reviewer（审查）：代码审查报告
- Tester（测试）：测试报告与缺陷清单

## 按需确认规则

- 默认由主 Agent 完成 PRD 与技术方案定稿并继续推进
- 仅在以下情况触发强制确认：用户明确要求确认；需求模糊导致无法得出单一最优解；分析发现需求逻辑冲突（规则互斥、前后矛盾或验收标准冲突）

## 回退原则

- 强制确认未通过则回退到上一阶段并携带修改意见
- 审查通过后进入测试，测试通过后进入完成
- 审查/测试不通过则回到编码阶段并携带问题清单

## 待开发清单（可选）

- 方案定稿后可登记至待开发清单（见 [docs/backlog/ready.md](../../../docs/backlog/ready.md)）
- 进入开发前从清单移除
- 主 Agent 按清单顺序推进，用户指示或主 Agent 提示后进入开发

## 逻辑冲突处理（必需）

- 测试发现问题后，先判断是代码问题还是逻辑/需求冲突
- 逻辑/需求冲突登记至逻辑问题清单（见 [docs/backlog/logic-issues.md](../../../docs/backlog/logic-issues.md)）
- 关联任务在待开发清单中标记阻塞
- 批量任务完成后集中澄清，确认后恢复流程
